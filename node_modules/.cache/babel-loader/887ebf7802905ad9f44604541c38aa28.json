{"ast":null,"code":"/* eslint-disable */\n\n/***********************************************************************************************\n  THIS IS AN AUTO-GENERATED FILE. DO NOT MAKE CHANGES HERE\n\n  Generated on: Wed Dec 09 2020 21:14:13 GMT+0000 (Coordinated Universal Time)\n************************************************************************************************/\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopDefault(ex) {\n  return ex && typeof ex === 'object' && 'default' in ex ? ex['default'] : ex;\n}\n\nvar _extends = _interopDefault(require('@babel/runtime/helpers/extends'));\n\nvar _objectWithoutProperties = _interopDefault(require('@babel/runtime/helpers/objectWithoutProperties'));\n\nvar React = require('react');\n\nvar React__default = _interopDefault(React);\n\nvar cx = _interopDefault(require('classnames'));\n\nvar _classCallCheck = _interopDefault(require('@babel/runtime/helpers/classCallCheck'));\n\nvar _createClass = _interopDefault(require('@babel/runtime/helpers/createClass'));\n\nvar _assertThisInitialized = _interopDefault(require('@babel/runtime/helpers/assertThisInitialized'));\n\nvar _inherits = _interopDefault(require('@babel/runtime/helpers/inherits'));\n\nvar _possibleConstructorReturn = _interopDefault(require('@babel/runtime/helpers/possibleConstructorReturn'));\n\nvar _getPrototypeOf = _interopDefault(require('@babel/runtime/helpers/getPrototypeOf'));\n\nvar _defineProperty = _interopDefault(require('@babel/runtime/helpers/defineProperty'));\n\nvar functionUtils = require('../../utils/functionUtils.js');\n\nvar formUtils = require('../../utils/formUtils.js');\n\nvar _prebuiltValidations = require('./validations/_prebuiltValidations.js');\n\nfunction _createSuper(Derived) {\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === \"function\") return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  return function () {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (isNativeReflectConstruct()) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n/**\n * A `Form` is a collection of inputs that allow the user to enter data. Form inputs are automatically laid out\n * in a design-system-compliant manner.\n *\n * `Form` has a set of pre-built validations available on [`Form.validations`](./form#Validations).\n *\n * > We defer to native browser behavior of form controls in regard to functionality and style as much as possible. We minimally augment the native functionality, but also provide means to work around these features in most cases. See [ADR 7: Minimally augment browser native behavior for form controls](adr-007-minimally-augment-browser-native-behavior-for-form-controls.md)\n *\n * **Requires *custom-event* polyfill for custom validations to work in IE11** [See Polyfills](./polyfills)\n */\n\n\nvar Form = /*#__PURE__*/function (_React$Component) {\n  _inherits(Form, _React$Component);\n\n  var _super = _createSuper(Form);\n\n  function Form(props) {\n    var _this;\n\n    _classCallCheck(this, Form);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSubmit\", function (event) {\n      var _this$props = _this.props,\n          onSubmit = _this$props.onSubmit,\n          preventDefaultInOnSubmitProp = _this$props.preventDefaultInOnSubmitProp,\n          onSubmitValidationError = _this$props.onSubmitValidationError;\n      var allFormElements = Array.from(event.target.elements).map(function (el) {\n        return {\n          el: el,\n          valid: el.checkValidity()\n        };\n      });\n      var invalidElements = allFormElements.filter(function (_ref) {\n        var valid = _ref.valid;\n        return !valid;\n      });\n      var isValid = invalidElements.length === 0;\n      var formData = formUtils.grabFormData(event.target);\n\n      if (isValid) {\n        preventDefaultInOnSubmitProp && onSubmit && event.preventDefault();\n        return functionUtils.callSafely(onSubmit)(formData, event);\n      } else {\n        event.preventDefault();\n        setTimeout(function () {\n          invalidElements[0].el.focus(); // Invoke onSubmitValidationError prop if the submission failed because of invalid fields:\n\n          var submittedFormDetails = Object.keys(formData).map(function (key) {\n            // Below is for field that would have multiple elements with the same 'name' attribute (like radio buttons), and the last element with that 'name' would have the properties we need\n            var elementsWithCurrentName = allFormElements.filter(function (_ref2) {\n              var el = _ref2.el;\n              return el.name === key;\n            });\n            var current = elementsWithCurrentName[elementsWithCurrentName.length - 1];\n            return {\n              name: key,\n              value: formData[key],\n              isValid: current.valid,\n              messagesShown: current.valid ? [] : JSON.parse(current.el.getAttribute('data-messagesShown'))\n            };\n          });\n          functionUtils.callSafely(onSubmitValidationError)(submittedFormDetails);\n        }, 0);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleReset\", function (event) {\n      var elements = event.target.elements;\n      Array.from(elements).forEach(function (el) {\n        functionUtils.callSafely(el.restoreDefaultState)();\n      });\n    });\n\n    _this.formRef = props.formRef || React__default.createRef();\n    return _this;\n  }\n\n  _createClass(Form, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.onValidationChange instanceof Function) {\n        this.formRef.current.addEventListener('validation', this.props.onValidationChange);\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (this.props.onValidationChange !== prevProps.onValidationChange) {\n        this.formRef.current.removeEventListener('validation', prevProps.onValidationChange);\n        this.formRef.current.addEventListener('validation', this.props.onValidationChange);\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (this.props.onValidationChange instanceof Function) {\n        this.formRef.current.removeEventListener('validation', this.props.onValidationChange);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          preventDefaultInOnSubmitProp = _this$props2.preventDefaultInOnSubmitProp,\n          onSubmit = _this$props2.onSubmit,\n          formRef = _this$props2.formRef,\n          onValidationChange = _this$props2.onValidationChange,\n          onReset = _this$props2.onReset,\n          onSubmitValidationError = _this$props2.onSubmitValidationError,\n          props = _objectWithoutProperties(_this$props2, [\"preventDefaultInOnSubmitProp\", \"onSubmit\", \"formRef\", \"onValidationChange\", \"onReset\", \"onSubmitValidationError\"]);\n\n      return React__default.createElement(\"form\", _extends({}, props, {\n        ref: this.formRef,\n        className: cx('kds-Form', this.props.className),\n        onSubmit: this.handleSubmit,\n        onReset: functionUtils.callAll(this.handleReset, onReset)\n      }));\n    }\n  }]);\n\n  return Form;\n}(React__default.Component);\n\n_defineProperty(Form, \"defaultProps\", {\n  method: 'POST',\n  preventDefaultInOnSubmitProp: true\n});\n\n_defineProperty(Form, \"validations\", _prebuiltValidations);\n\nexports.default = Form;","map":{"version":3,"sources":["kds-react/src/components/Form/Form.js"],"names":["Form","React","Component","method","preventDefaultInOnSubmitProp","prebuiltValidations","props","prevProps","onSubmit","onSubmitValidationError","allFormElements","event","el","valid","invalidElements","isValid","formData","grabFormData","callSafely","setTimeout","submittedFormDetails","elementsWithCurrentName","current","name","value","messagesShown","JSON","elements","Array","formRef","onValidationChange","onReset","cx","callAll"],"mappings":"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","sourcesContent":["import cx from 'classnames'\nimport PropTypes from 'prop-types'\nimport React from 'react'\nimport { grabFormData } from '../../utils/formUtils'\nimport { callAll, callSafely } from '../../utils/functionUtils'\nimport * as prebuiltValidations from './validations/_prebuiltValidations'\n\n/**\n * A `Form` is a collection of inputs that allow the user to enter data. Form inputs are automatically laid out\n * in a design-system-compliant manner.\n *\n * `Form` has a set of pre-built validations available on [`Form.validations`](./form#Validations).\n *\n * > We defer to native browser behavior of form controls in regard to functionality and style as much as possible. We minimally augment the native functionality, but also provide means to work around these features in most cases. See [ADR 7: Minimally augment browser native behavior for form controls](adr-007-minimally-augment-browser-native-behavior-for-form-controls.md)\n *\n * **Requires *custom-event* polyfill for custom validations to work in IE11** [See Polyfills](./polyfills)\n */\nclass Form extends React.Component {\n  static propTypes = {\n    /** A function to be called on form submission.\n     *\n     > If provided, we will call `event.preventDefault()` on your behalf because this is a majority use case scenario.\n     > If you don't want this behavior, pass `false` to the `preventDefaultInOnSubmitProp` prop.\n     *\n     * @param { object } formData An object of input names matched to input values\n     * @param { object } event The submit event object\n     */\n    onSubmit: PropTypes.func,\n    /** A function to be called when a form submission attempt failed because of validation errors.\n     * @param {Object[]} submittedFormDetails - An array of the details of all the form fields in the form, with the folowing shape:\n     * @param {string} submittedFormDetails[].name - 'name' attribute of the form field.\n     * @param {string} submittedFormDetails[].value - Value of the form field.\n     * @param {boolean} submittedFormDetails[].isValid - Whether the form field is valid or not.\n     * @param {Object[]} submittedFormDetails[].messagesShown - An array of messages shown for the form field, with the following shape:\n     * @param {string} messagesShown[].messageText - Message text.\n     * @param {string} messagesShown[].messageKind - One of 'error' or 'success'.\n     */\n    onSubmitValidationError: PropTypes.func,\n    /** A function to be called when validation state changes.\n     *\n     * @param { object } event A validation event object\n     * @param { object } event.target The element on which the validation messages changed\n     * @param { array } event.detail.messagesShown A list of the message types shown to the user\n     */\n    onValidationChange: PropTypes.func,\n    /** A function to be called when the form is reset. */\n    onReset: PropTypes.func,\n    /** Pass utility classes to the container element */\n    className: PropTypes.string,\n    /** If `false`, then `event.preventDefault()` will not be called before the `onSubmit` prop is called. */\n    preventDefaultInOnSubmitProp: PropTypes.bool,\n    /** The HTTP method that the form uses to create a request. */\n    method: PropTypes.string,\n    /** Allow users to handle the ref on the form. Can be used to reset the form if needed. */\n    formRef: PropTypes.ref\n  }\n\n  static defaultProps = {\n    method: 'POST',\n    preventDefaultInOnSubmitProp: true\n  }\n\n  static validations = prebuiltValidations\n\n  constructor (props) {\n    super(props)\n\n    this.formRef = props.formRef || React.createRef()\n  }\n\n  componentDidMount () {\n    if (this.props.onValidationChange instanceof Function) {\n      this.formRef.current.addEventListener(\n        'validation',\n        this.props.onValidationChange\n      )\n    }\n  }\n\n  componentDidUpdate (prevProps) {\n    if (this.props.onValidationChange !== prevProps.onValidationChange) {\n      this.formRef.current.removeEventListener(\n        'validation',\n        prevProps.onValidationChange\n      )\n      this.formRef.current.addEventListener(\n        'validation',\n        this.props.onValidationChange\n      )\n    }\n  }\n\n  componentWillUnmount () {\n    if (this.props.onValidationChange instanceof Function) {\n      this.formRef.current.removeEventListener(\n        'validation',\n        this.props.onValidationChange\n      )\n    }\n  }\n\n  handleSubmit = event => {\n    const {\n      onSubmit,\n      preventDefaultInOnSubmitProp,\n      onSubmitValidationError\n    } = this.props\n    const allFormElements = Array.from(event.target.elements).map(el => ({\n      el,\n      valid: el.checkValidity()\n    }))\n    const invalidElements = allFormElements.filter(({ valid }) => !valid)\n    const isValid = invalidElements.length === 0\n    const formData = grabFormData(event.target)\n\n    if (isValid) {\n      preventDefaultInOnSubmitProp && onSubmit && event.preventDefault()\n\n      return callSafely(onSubmit)(formData, event)\n    } else {\n      event.preventDefault()\n      setTimeout(() => {\n        invalidElements[0].el.focus()\n\n        // Invoke onSubmitValidationError prop if the submission failed because of invalid fields:\n        const submittedFormDetails = Object.keys(formData).map(key => {\n          // Below is for field that would have multiple elements with the same 'name' attribute (like radio buttons), and the last element with that 'name' would have the properties we need\n          const elementsWithCurrentName = allFormElements.filter(\n            ({ el }) => el.name === key\n          )\n          const current =\n            elementsWithCurrentName[elementsWithCurrentName.length - 1]\n\n          return {\n            name: key,\n            value: formData[key],\n            isValid: current.valid,\n            messagesShown: current.valid\n              ? []\n              : JSON.parse(current.el.getAttribute('data-messagesShown'))\n          }\n        })\n\n        callSafely(onSubmitValidationError)(submittedFormDetails)\n      }, 0)\n    }\n  }\n\n  handleReset = event => {\n    const elements = event.target.elements\n    Array.from(elements).forEach(el => {\n      callSafely(el.restoreDefaultState)()\n    })\n  }\n\n  render () {\n    const {\n      preventDefaultInOnSubmitProp,\n      onSubmit,\n      formRef,\n      onValidationChange,\n      onReset,\n      onSubmitValidationError,\n      ...props\n    } = this.props\n    return (\n      <form\n        {...props}\n        ref={this.formRef}\n        className={cx('kds-Form', this.props.className)}\n        onSubmit={this.handleSubmit}\n        onReset={callAll(this.handleReset, onReset)}\n      />\n    )\n  }\n}\n\nexport default Form\n"]},"metadata":{},"sourceType":"script"}