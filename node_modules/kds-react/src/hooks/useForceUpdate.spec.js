import React from 'react'
import { render, fireEvent } from 'react-testing-library'
import useForceUpdate from './useForceUpdate'

describe('forceUpdate', () => {
  // Store a render count that increments every time the component rerenders
  let noOfRenders = 0
  let TestComp = () => null

  beforeEach(() => {
    noOfRenders = 0

    TestComp = () => {
      const forceUpdate = useForceUpdate()

      noOfRenders++

      return (
        <button data-testid="button" onClick={forceUpdate}>
          {noOfRenders}
        </button>
      )
    }
  })

  it('should update the component every time', () => {
    const { getByTestId } = render(<TestComp />)

    const button = getByTestId('button')

    expect(button).toHaveTextContent('1')

    fireEvent.click(button)
    expect(button).toHaveTextContent('2')

    fireEvent.click(button)
    expect(button).toHaveTextContent('3')
  })
})
