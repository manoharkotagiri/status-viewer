import React from 'react'
import PropTypes from 'prop-types'
import cx from 'classnames'
import { callAll } from '../../utils/functionUtils'

/**
 * Menu is used by `BreadcrumbMenu` for composing the intermediate/collapsed breadcrumbs and cloning those breadcrumbs with an onClick handler for hiding the menu when a breadcrumb is clicked. It will call that handler along with any onClick prop on the child.
 */
const Menu = ({ children, className, onChildClick, compact, ...rest }) => (
  <menu {...rest} className={cx(className, 'kds-Menu')}>
    {React.Children.map(children, child =>
      React.cloneElement(child, {
        className: cx(child.props.className, 'kds-Menu-item', {
          'kds-Menu-item--compact': compact
        }),
        onClick: callAll(onChildClick, child.props.onClick)
      })
    )}
  </menu>
)

Menu.defaultProps = {
  onChildClick: () => {}
}

Menu.propTypes = {
  /** Callback that will be added to onClick of each child. */
  onChildClick: PropTypes.func,
  /** Links that populate the menu */
  children: PropTypes.element,
  /** Pass utility classes to the container element */
  className: PropTypes.string,
  /** Compact menu item size. Used when space is limited. */
  compact: PropTypes.bool
}

export default Menu
