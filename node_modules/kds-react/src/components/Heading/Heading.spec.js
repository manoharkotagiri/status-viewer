import React from 'react'
import { render } from 'react-testing-library'
import { headingContract } from 'kds-web-e-commerce-theme'
import { getPermutationsAsArray } from '../../utils/generateComponents'
import Heading, { sizeOpts, tagOpts } from './Heading'

describe('<Heading>', () => {
  const AllPossibleHeadingStates = getPermutationsAsArray(Heading, {
    tagOpts: [undefined, ...tagOpts],
    sizeOpts: [undefined, ...sizeOpts],
    children: ['My Heading']
  })

  describe('renders all possible label states and all pass contract tests', () => {
    AllPossibleHeadingStates.forEach(({ jsx, props }) => {
      it(`with Props: ${JSON.stringify(props)}`, () => {
        const { container } = render(jsx)

        expect(container).toMatchSnapshot()
        expect(headingContract.validateHTML(container.innerHTML)).toBeTruthy()
      })
    })
  })

  it('adds custom className passed in as a prop', () => {
    const className = 'sichuan'
    const { container } = render(<Heading className={className} />)

    expect(container.firstChild.getAttribute('class')).toMatchInlineSnapshot(
      `"kds-Heading kds-Heading--l sichuan"`
    )
  })

  it('spreads attributes onto the rendered element', () => {
    const { container } = render(<Heading id="myHeading" />)

    expect(container.firstChild).toHaveAttribute('id', 'myHeading')
  })

  it('Allows overriding of default tag', () => {
    const { container } = render(<Heading size="l" tag="h6" />)

    expect(container.firstChild).toMatchInlineSnapshot(`
<h6
  class="kds-Heading kds-Heading--l"
/>
`)
  })
})
