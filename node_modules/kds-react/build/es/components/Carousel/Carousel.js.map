{"version":3,"file":"Carousel.js","sources":["kds-react/src/components/Carousel/Carousel.js"],"sourcesContent":["import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport cx from 'classnames'\nimport Button from '../Button/Button'\nimport {\n  IconCaretLeft,\n  IconCaretRight,\n  IconSkipToEnd,\n  IconSkipToStart\n} from '../Icon/index'\nimport useForceUpdate from '../../hooks/useForceUpdate'\nimport useOnResize from '../../hooks/useOnResize'\nimport {\n  getCarouselWidth,\n  getTemplateWidth,\n  getNumberOfItemsShown,\n  getFullContainerWidth,\n  getStartIndexToRender,\n  getEndIndexToRender,\n  getNumberOfSections,\n  getCurrentSection,\n  getIsAtStartOfCarousel,\n  getIsAtEndOfCarousel,\n  useCarouselOnScrollCallback,\n  useCarouselOnPreviousButtonClickCallback,\n  useCarouselOnNextButtonClickCallback,\n  useOnSkipToStartButtonClickCallback,\n  useOnSkipToEndButtonClickCallback,\n  CAROUSEL_GUTTER_WIDTH\n} from './_carouselFunctions'\nimport { PaginationDots } from './_PaginationDots'\n\n/**\n * A Carousel is a grouping of similar elements (products, coupons, etc.) that that can be navigated horizontally.\n *\n * > **Note:** `<Carousel />` renders a `div` with any additional props like `id` etc spread on to the `.kds-Carousel-contentWindow` div, like so: `<div {...props} />`.\n */\nconst Carousel = ({\n  className,\n  data,\n  description,\n  template: Template,\n  keyBy,\n  hideGradients,\n  ...props\n}) => {\n  const [carousel, setCarouselRef] = useState()\n  const forceUpdate = useForceUpdate()\n  const [\n    firstFullyVisibleElementIndex,\n    setFirstFullyVisibleElementIndex\n  ] = useState(0)\n\n  useOnResize({ onResize: forceUpdate })\n\n  const carouselWidth = getCarouselWidth(carousel)\n  const templateWidth = getTemplateWidth(carousel)\n  const templateWithGutterWidth = templateWidth + CAROUSEL_GUTTER_WIDTH\n\n  const totalNumberOfItems = data.length\n  const numberOfItemsShown = getNumberOfItemsShown(\n    carouselWidth,\n    templateWithGutterWidth\n  )\n\n  const containerWidth = getFullContainerWidth(\n    templateWithGutterWidth,\n    totalNumberOfItems\n  )\n\n  const isAtStartOfCarousel = getIsAtStartOfCarousel(carousel)\n  const isAtEndOfCarousel = getIsAtEndOfCarousel(carousel, containerWidth)\n\n  const onScroll = useCarouselOnScrollCallback({\n    carousel,\n    containerWidth,\n    templateWithGutterWidth,\n    firstFullyVisibleElementIndex,\n    setFirstFullyVisibleElementIndex,\n    forceUpdate,\n    previousIsAtEndOfCarousel: isAtEndOfCarousel\n  })\n\n  const onNextButtonClick = useCarouselOnNextButtonClickCallback({\n    carousel,\n    templateWithGutterWidth,\n    templateWidth,\n    numberOfItemsShown\n  })\n\n  const onPreviousButtonClick = useCarouselOnPreviousButtonClickCallback({\n    carousel,\n    containerWidth,\n    templateWithGutterWidth,\n    numberOfItemsShown\n  })\n\n  const onSkipToStartButtonClick = useOnSkipToStartButtonClickCallback({\n    carousel\n  })\n\n  const onSkipToEndButtonClick = useOnSkipToEndButtonClickCallback({\n    carousel,\n    templateWithGutterWidth,\n    totalNumberOfItems,\n    containerWidth\n  })\n\n  const startOfData = getStartIndexToRender(\n    firstFullyVisibleElementIndex,\n    numberOfItemsShown\n  )\n\n  const endOfData = getEndIndexToRender(\n    totalNumberOfItems,\n    firstFullyVisibleElementIndex,\n    numberOfItemsShown\n  )\n\n  const dataToRender = data.slice(startOfData, endOfData)\n\n  const numberOfSections = getNumberOfSections(\n    carouselWidth,\n    totalNumberOfItems,\n    numberOfItemsShown\n  )\n\n  const currentSection = getCurrentSection(\n    firstFullyVisibleElementIndex,\n    numberOfItemsShown,\n    numberOfSections,\n    isAtEndOfCarousel,\n    totalNumberOfItems\n  )\n\n  return (\n    <div className=\"kds-Carousel\">\n      <div className=\"kds-Carousel-wrapper\">\n        <Button\n          aria-label={`View previous ${description}`}\n          className=\"kds-Carousel-button kds-Carousel-button--previous\"\n          kind=\"secondary\"\n          disabled={isAtStartOfCarousel}\n          onClick={onPreviousButtonClick}\n        >\n          <IconCaretLeft />\n        </Button>\n        <div\n          className={cx('kds-Carousel-gradientContainer', {\n            'kds-Carousel-hideStartGradient':\n              hideGradients || isAtStartOfCarousel,\n            'kds-Carousel-hideEndGradient': hideGradients || isAtEndOfCarousel\n          })}\n        >\n          <div\n            className={cx('kds-Carousel-contentWindow', className)}\n            ref={setCarouselRef}\n            onScroll={onScroll}\n            {...props}\n          >\n            <div\n              style={{ width: containerWidth }}\n              className=\"kds-Carousel-contentContainer\"\n            >\n              <ul\n                role=\"presentation\"\n                style={{\n                  left: startOfData * templateWithGutterWidth\n                }}\n                className=\"kds-Carousel-itemList\"\n              >\n                {dataToRender.map((propsForTemplate, index) => {\n                  const itemKey = propsForTemplate[keyBy]\n                  const actualItemIndex = startOfData + index\n                  const isItemVisible =\n                    actualItemIndex >= firstFullyVisibleElementIndex &&\n                    actualItemIndex <\n                      firstFullyVisibleElementIndex + numberOfItemsShown\n                  return (\n                    <li\n                      aria-setsize={totalNumberOfItems}\n                      aria-posinset={actualItemIndex + 1}\n                      key={itemKey}\n                      className={cx('kds-Carousel-item')}\n                      // we don't want our screenreader users to get caught in an infinitely loading carousel,\n                      // so we prevent them from focusing the next (hidden) element & scrolling it into view\n                      aria-hidden={!isItemVisible}\n                      aria-label={`Item ${actualItemIndex +\n                        1} of ${totalNumberOfItems}`}\n                      tabIndex={-1}\n                      data-itemindex={index}\n                    >\n                      <Template {...propsForTemplate} key={itemKey} />\n                      {/* Skip Buttons for keyboard users so they don't get trapped */}\n                      {!((actualItemIndex + 1) % 10) &&\n                      !(actualItemIndex === 0) &&\n                      !(actualItemIndex === totalNumberOfItems - 1) && ( // no skip buttons in the beginning or end\n                      <>\n                        <Button\n                          compact\n                          aria-label={`Skip to first item of carousel`}\n                          className=\"kds-Carousel-button--skip\"\n                          kind=\"secondary\"\n                          onClick={onSkipToStartButtonClick}\n                        >\n                          <IconSkipToStart />\n                        </Button>\n                        <Button\n                          compact\n                          aria-label={`Skip to last item of carousel`}\n                          className=\"kds-Carousel-button--skip\"\n                          kind=\"secondary\"\n                          onClick={onSkipToEndButtonClick}\n                        >\n                          <IconSkipToEnd />\n                        </Button>\n                      </>\n                      )}\n                    </li>\n                  )\n                })}\n              </ul>\n            </div>\n          </div>\n        </div>\n        <Button\n          aria-label={`View next ${description}`}\n          className=\"kds-Carousel-button kds-Carousel-button--next\"\n          kind=\"secondary\"\n          onClick={onNextButtonClick}\n          disabled={isAtEndOfCarousel}\n        >\n          <IconCaretRight />\n        </Button>\n      </div>\n      <PaginationDots\n        currentSection={currentSection}\n        numberOfSections={numberOfSections}\n      />\n    </div>\n  )\n}\n\nCarousel.propTypes = {\n  /** Data for the carousel, each element of this array will be passed as data to the `template` component\n   * ```Message { \"props\": { \"kind\": \"info\", \"className\": \"mb-16\" } }\n   * A key property in each element of the data array must be present if `keyBy` prop is not provided.\n   * ```\n   */\n  data: PropTypes.array,\n  /** Description for the carousel */\n  description: PropTypes.string,\n  /** Template to render each element of the `data` array. Should be a component definition (not a render prop).\n   * ```Message { \"props\": { \"kind\": \"info\", \"className\": \"mb-16\" } }\n   * All items should be the same width.\n   * ```\n   */\n  template: PropTypes.element,\n  /** Name of the property in the data to be used as the key for each item */\n  keyBy: PropTypes.string,\n  hideGradients: PropTypes.bool\n}\n\nCarousel.defaultProps = {\n  data: [],\n  description: 'items',\n  keyBy: 'key',\n  hideGradients: false\n}\n\nexport default Carousel\n"],"names":["Carousel","className","data","description","Template","template","keyBy","hideGradients","props","useState","carousel","setCarouselRef","forceUpdate","useForceUpdate","firstFullyVisibleElementIndex","setFirstFullyVisibleElementIndex","useOnResize","onResize","carouselWidth","getCarouselWidth","templateWidth","getTemplateWidth","templateWithGutterWidth","CAROUSEL_GUTTER_WIDTH","totalNumberOfItems","length","numberOfItemsShown","getNumberOfItemsShown","containerWidth","getFullContainerWidth","isAtStartOfCarousel","getIsAtStartOfCarousel","isAtEndOfCarousel","getIsAtEndOfCarousel","onScroll","useCarouselOnScrollCallback","previousIsAtEndOfCarousel","onNextButtonClick","useCarouselOnNextButtonClickCallback","onPreviousButtonClick","useCarouselOnPreviousButtonClickCallback","onSkipToStartButtonClick","useOnSkipToStartButtonClickCallback","onSkipToEndButtonClick","useOnSkipToEndButtonClickCallback","startOfData","getStartIndexToRender","endOfData","getEndIndexToRender","dataToRender","slice","numberOfSections","getNumberOfSections","currentSection","getCurrentSection","cx","width","left","map","propsForTemplate","index","itemKey","actualItemIndex","isItemVisible","defaultProps"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;;;;;;AAKA,IAAMA,QAAQ,GAAG,SAAXA,QAAW,OAQX;AAAA,MAPJC,SAOI,QAPJA,SAOI;AAAA,MANJC,IAMI,QANJA,IAMI;AAAA,MALJC,WAKI,QALJA,WAKI;AAAA,MAJMC,QAIN,QAJJC,QAII;AAAA,MAHJC,KAGI,QAHJA,KAGI;AAAA,MAFJC,aAEI,QAFJA,aAEI;AAAA,MADDC,KACC;;AAAA,kBAC+BC,QAAQ,EADvC;AAAA;AAAA,MACGC,QADH;AAAA,MACaC,cADb;;AAEJ,MAAMC,WAAW,GAAGC,cAAc,EAAlC;;AAFI,mBAMAJ,QAAQ,CAAC,CAAD,CANR;AAAA;AAAA,MAIFK,6BAJE;AAAA,MAKFC,gCALE;;AAQJC,EAAAA,WAAW,CAAC;AAAEC,IAAAA,QAAQ,EAAEL;AAAZ,GAAD,CAAX;AAEA,MAAMM,aAAa,GAAGC,gBAAgB,CAACT,QAAD,CAAtC;AACA,MAAMU,aAAa,GAAGC,gBAAgB,CAACX,QAAD,CAAtC;AACA,MAAMY,uBAAuB,GAAGF,aAAa,GAAGG,qBAAhD;AAEA,MAAMC,kBAAkB,GAAGtB,IAAI,CAACuB,MAAhC;AACA,MAAMC,kBAAkB,GAAGC,qBAAqB,CAC9CT,aAD8C,EAE9CI,uBAF8C,CAAhD;AAKA,MAAMM,cAAc,GAAGC,qBAAqB,CAC1CP,uBAD0C,EAE1CE,kBAF0C,CAA5C;AAKA,MAAMM,mBAAmB,GAAGC,sBAAsB,CAACrB,QAAD,CAAlD;AACA,MAAMsB,iBAAiB,GAAGC,oBAAoB,CAACvB,QAAD,EAAWkB,cAAX,CAA9C;AAEA,MAAMM,QAAQ,GAAGC,2BAA2B,CAAC;AAC3CzB,IAAAA,QAAQ,EAARA,QAD2C;AAE3CkB,IAAAA,cAAc,EAAdA,cAF2C;AAG3CN,IAAAA,uBAAuB,EAAvBA,uBAH2C;AAI3CR,IAAAA,6BAA6B,EAA7BA,6BAJ2C;AAK3CC,IAAAA,gCAAgC,EAAhCA,gCAL2C;AAM3CH,IAAAA,WAAW,EAAXA,WAN2C;AAO3CwB,IAAAA,yBAAyB,EAAEJ;AAPgB,GAAD,CAA5C;AAUA,MAAMK,iBAAiB,GAAGC,oCAAoC,CAAC;AAC7D5B,IAAAA,QAAQ,EAARA,QAD6D;AAE7DY,IAAAA,uBAAuB,EAAvBA,uBAF6D;AAG7DF,IAAAA,aAAa,EAAbA,aAH6D;AAI7DM,IAAAA,kBAAkB,EAAlBA;AAJ6D,GAAD,CAA9D;AAOA,MAAMa,qBAAqB,GAAGC,wCAAwC,CAAC;AACrE9B,IAAAA,QAAQ,EAARA,QADqE;AAErEkB,IAAAA,cAAc,EAAdA,cAFqE;AAGrEN,IAAAA,uBAAuB,EAAvBA,uBAHqE;AAIrEI,IAAAA,kBAAkB,EAAlBA;AAJqE,GAAD,CAAtE;AAOA,MAAMe,wBAAwB,GAAGC,mCAAmC,CAAC;AACnEhC,IAAAA,QAAQ,EAARA;AADmE,GAAD,CAApE;AAIA,MAAMiC,sBAAsB,GAAGC,iCAAiC,CAAC;AAC/DlC,IAAAA,QAAQ,EAARA,QAD+D;AAE/DY,IAAAA,uBAAuB,EAAvBA,uBAF+D;AAG/DE,IAAAA,kBAAkB,EAAlBA,kBAH+D;AAI/DI,IAAAA,cAAc,EAAdA;AAJ+D,GAAD,CAAhE;AAOA,MAAMiB,WAAW,GAAGC,qBAAqB,CACvChC,6BADuC,EAEvCY,kBAFuC,CAAzC;AAKA,MAAMqB,SAAS,GAAGC,mBAAmB,CACnCxB,kBADmC,EAEnCV,6BAFmC,EAGnCY,kBAHmC,CAArC;AAMA,MAAMuB,YAAY,GAAG/C,IAAI,CAACgD,KAAL,CAAWL,WAAX,EAAwBE,SAAxB,CAArB;AAEA,MAAMI,gBAAgB,GAAGC,mBAAmB,CAC1ClC,aAD0C,EAE1CM,kBAF0C,EAG1CE,kBAH0C,CAA5C;AAMA,MAAM2B,cAAc,GAAGC,iBAAiB,CACtCxC,6BADsC,EAEtCY,kBAFsC,EAGtCyB,gBAHsC,EAItCnB,iBAJsC,EAKtCR,kBALsC,CAAxC;AAQA,SACE;AAAK,IAAA,SAAS,EAAC;AAAf,KACE;AAAK,IAAA,SAAS,EAAC;AAAf,KACE,oBAAC,MAAD;AACE,0CAA6BrB,WAA7B,CADF;AAEE,IAAA,SAAS,EAAC,mDAFZ;AAGE,IAAA,IAAI,EAAC,WAHP;AAIE,IAAA,QAAQ,EAAE2B,mBAJZ;AAKE,IAAA,OAAO,EAAES;AALX,KAOE,oBAAC,aAAD,OAPF,CADF,EAUE;AACE,IAAA,SAAS,EAAEgB,EAAE,CAAC,gCAAD,EAAmC;AAC9C,wCACEhD,aAAa,IAAIuB,mBAF2B;AAG9C,sCAAgCvB,aAAa,IAAIyB;AAHH,KAAnC;AADf,KAOE;AACE,IAAA,SAAS,EAAEuB,EAAE,CAAC,4BAAD,EAA+BtD,SAA/B,CADf;AAEE,IAAA,GAAG,EAAEU,cAFP;AAGE,IAAA,QAAQ,EAAEuB;AAHZ,KAIM1B,KAJN,GAME;AACE,IAAA,KAAK,EAAE;AAAEgD,MAAAA,KAAK,EAAE5B;AAAT,KADT;AAEE,IAAA,SAAS,EAAC;AAFZ,KAIE;AACE,IAAA,IAAI,EAAC,cADP;AAEE,IAAA,KAAK,EAAE;AACL6B,MAAAA,IAAI,EAAEZ,WAAW,GAAGvB;AADf,KAFT;AAKE,IAAA,SAAS,EAAC;AALZ,KAOG2B,YAAY,CAACS,GAAb,CAAiB,UAACC,gBAAD,EAAmBC,KAAnB,EAA6B;AAC7C,QAAMC,OAAO,GAAGF,gBAAgB,CAACrD,KAAD,CAAhC;AACA,QAAMwD,eAAe,GAAGjB,WAAW,GAAGe,KAAtC;AACA,QAAMG,aAAa,GACjBD,eAAe,IAAIhD,6BAAnB,IACAgD,eAAe,GACbhD,6BAA6B,GAAGY,kBAHpC;AAIA,WACE;AACE,sBAAcF,kBADhB;AAEE,uBAAesC,eAAe,GAAG,CAFnC;AAGE,MAAA,GAAG,EAAED,OAHP;AAIE,MAAA,SAAS,EAAEN,EAAE,CAAC,mBAAD,CAJf;AAME;AANF;AAOE,qBAAa,CAACQ,aAPhB;AAQE,mCAAoBD,eAAe,GACjC,CADF,iBACUtC,kBADV,CARF;AAUE,MAAA,QAAQ,EAAE,CAAC,CAVb;AAWE,wBAAgBoC;AAXlB,OAaE,oBAAC,QAAD,eAAcD,gBAAd;AAAgC,MAAA,GAAG,EAAEE;AAArC,OAbF,EAeG,EAAE,CAACC,eAAe,GAAG,CAAnB,IAAwB,EAA1B,KACD,EAAEA,eAAe,KAAK,CAAtB,CADC,IAED,EAAEA,eAAe,KAAKtC,kBAAkB,GAAG,CAA3C,CAFC;AAGD,8CACE,oBAAC,MAAD;AACE,MAAA,OAAO,MADT;AAEE,oDAFF;AAGE,MAAA,SAAS,EAAC,2BAHZ;AAIE,MAAA,IAAI,EAAC,WAJP;AAKE,MAAA,OAAO,EAAEiB;AALX,OAOE,oBAAC,eAAD,OAPF,CADF,EAUE,oBAAC,MAAD;AACE,MAAA,OAAO,MADT;AAEE,mDAFF;AAGE,MAAA,SAAS,EAAC,2BAHZ;AAIE,MAAA,IAAI,EAAC,WAJP;AAKE,MAAA,OAAO,EAAEE;AALX,OAOE,oBAAC,aAAD,OAPF,CAVF,CAlBF,CADF;AA0CD,GAjDA,CAPH,CAJF,CANF,CAPF,CAVF,EAwFE,oBAAC,MAAD;AACE,sCAAyBxC,WAAzB,CADF;AAEE,IAAA,SAAS,EAAC,+CAFZ;AAGE,IAAA,IAAI,EAAC,WAHP;AAIE,IAAA,OAAO,EAAEkC,iBAJX;AAKE,IAAA,QAAQ,EAAEL;AALZ,KAOE,oBAAC,cAAD,OAPF,CAxFF,CADF,EAmGE,oBAAC,cAAD;AACE,IAAA,cAAc,EAAEqB,cADlB;AAEE,IAAA,gBAAgB,EAAEF;AAFpB,IAnGF,CADF;AA0GD,CA5MD;;AAkOAnD,QAAQ,CAACgE,YAAT,GAAwB;AACtB9D,EAAAA,IAAI,EAAE,EADgB;AAEtBC,EAAAA,WAAW,EAAE,OAFS;AAGtBG,EAAAA,KAAK,EAAE,KAHe;AAItBC,EAAAA,aAAa,EAAE;AAJO,CAAxB;;"}