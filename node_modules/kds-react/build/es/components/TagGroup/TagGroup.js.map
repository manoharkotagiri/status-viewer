{"version":3,"file":"TagGroup.js","sources":["kds-react/src/components/TagGroup/TagGroup.js"],"sourcesContent":["import React, { Component } from 'react'\nimport cx from 'classnames'\nimport PropTypes from 'prop-types'\n\n/**\n * TagGroup render a list of one or more Tag components.\n */\nclass TagGroup extends Component {\n  static propTypes = {\n    /** One or more `<Tag>` components */\n    children: PropTypes.arrayOf(\n      PropTypes.shape({\n        type: TagGroup\n      })\n    ),\n    /** Optional className to be applied to the container node */\n    className: PropTypes.string,\n    'aria-label': PropTypes.string,\n    layout: PropTypes.oneOf(['wrap', 'scroll'])\n  }\n\n  static defaultProps = {\n    className: '',\n    layout: 'wrap'\n  }\n\n  constructor (props) {\n    super(props)\n\n    this.state = { tagState: new Map() }\n\n    this.props.children &&\n      this.props.children.map((child, index) => {\n        if (child.type.displayName && child.type.displayName === 'Tag') {\n          this.state.tagState.set(index, {\n            isRemoved: false, //  existing in DOM\n            ref: React.createRef()\n          })\n        }\n      })\n  }\n\n  removeTag = idxToRemove => {\n    const state = this.state.tagState.get(idxToRemove)\n    state.isRemoved = true\n    this.state.tagState.set(idxToRemove, state)\n    this.moveFocus(idxToRemove)\n  }\n\n  moveFocus = originalIdx => {\n    //  looking for possible prev element\n    const prevExistingTags = []\n    const nextExistingTags = []\n\n    for (const [key, value] of this.state.tagState) {\n      if (key < originalIdx && !value.isRemoved) {\n        prevExistingTags.push(value)\n      } else if (key > originalIdx && !value.isRemoved) {\n        nextExistingTags.push(value)\n      } else {\n        continue\n      }\n    }\n\n    if (prevExistingTags.length > 0) {\n      prevExistingTags[prevExistingTags.length - 1].ref.current.focus()\n      return\n    }\n\n    if (nextExistingTags.length > 0) {\n      nextExistingTags[0].ref.current.focus()\n    }\n  }\n\n  //  check if action and non-action Tags are mixed, if it's mixed, prevent it.\n  isNonMixedTagsKinds = () => {\n    const childrenArr = React.Children.toArray(this.props.children).filter(\n      child => child.type.displayName && child.type.displayName === 'Tag'\n    )\n\n    if (childrenArr.length === 0) {\n      return true\n    }\n\n    if (\n      childrenArr[0].props.kind === 'interactive' ||\n      childrenArr[0].props.kind === 'action'\n    ) {\n      return childrenArr.every(\n        child =>\n          child.type !== 'Tag' ||\n          (child.type === 'Tag' &&\n            (child.props.kind === 'interactive' ||\n              child.props.kind === 'action'))\n      )\n    }\n\n    if (\n      childrenArr[0].props.kind !== 'interactive' &&\n      childrenArr[0].props.kind !== 'action'\n    ) {\n      return childrenArr.every(\n        child =>\n          child.props.kind !== 'interactive' && child.props.kind !== 'action'\n      )\n    }\n  }\n\n  renderChildren = () => {\n    const childrenArr = React.Children.toArray(this.props.children)\n\n    return childrenArr.map((child, index) => {\n      if (child.type.displayName && child.type.displayName === 'Tag') {\n        return React.cloneElement(child, {\n          tag: 'li',\n          role: 'listitem',\n          'data-index': index,\n          ref: this.state.tagState.get(index).ref,\n          onRemove: this.removeTag\n        })\n      }\n\n      return child\n    })\n  }\n\n  render () {\n    const {\n      className,\n      children,\n      'aria-label': ariaLabel,\n      layout,\n      ...props\n    } = this.props\n\n    // if (!this.isNonMixedTagsKinds() && process.env.NODE_ENV === 'development') {\n    //   console.warn('action kind and non-action kind Tag should not be mixed in TagGroup')\n    //   return null\n    // }\n\n    return (\n      <section\n        className={cx(\n          'kds-TagGroup',\n          { 'with-scroll': layout === 'scroll' },\n          className\n        )}\n        aria-label={`Tag Group: ${ariaLabel}`}\n        {...props}\n      >\n        <ul className=\"kds-TagGroup-list\">{this.renderChildren()}</ul>\n      </section>\n    )\n  }\n}\n\nexport default TagGroup\n"],"names":["TagGroup","props","idxToRemove","state","tagState","get","isRemoved","set","moveFocus","originalIdx","prevExistingTags","nextExistingTags","key","value","push","length","ref","current","focus","childrenArr","React","Children","toArray","children","filter","child","type","displayName","kind","every","map","index","cloneElement","tag","role","onRemove","removeTag","Map","createRef","className","ariaLabel","layout","cx","renderChildren","Component"],"mappings":"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"}